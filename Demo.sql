create table Associate(
  associateId number,
  firstName varchar2(50) not null,
  lastName varchar2(50) not null,
  yearlyInvestmentUnder80C number,
  department varchar2(50) not null,
  designation varchar2(50) not null,
  pancard varchar2(50) not null,
  emainId varchar2(50) not null
)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
desc Associate
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
select * from Associate
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
select * from Associate
  order by AssociateId
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
select * from Associate
  where yearlyInvestmentUnder80C >9000 and yearlyInvestmentUnder80C <20000
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
drop table Associate
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
alter table Associate
  add constraint PK_AssociateID
  primary key(associateId)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
alter table Associate
  add constraint UK_EmailId
  unique(emailId)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
create table salary(
  hra number,
  conveyenceallowance number,
  otherallowance number,personalallowance number,
  monthlytax number,
  epf number,
  company number,
  grosssalary number,
  netsalary number
)
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
desc salary
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
alter table salary
  add associateId number
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
alter table salary
  add constraint FK_AssociateID
  foreign key(associateId) REFERENCES Associate(associateId)
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
select * form salary
  order by associateId desc
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
create table bankdetails(
accountNumber number,
bankname varchar2(50) not null,
ifscCode varchar2(50) not null
)
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
desc bankdetails
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
alter table bankdetails
  add associateId number
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
alter table bankdetails
  add constraint FK_AssociateID
  foreign key(associateId) REFERENCES Associate(associateId)
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
create view AssociateBankDetails
As
  select a.associateId,a.firstName,a.lastName,b.bankName,b.ifscCode
    from Associate a,bankDetails b
        where a.associateId = b.associateId;
        
  select * from AssociateBankDetails;
   --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
   SET SERVET OUTPUT ON
   
   begin
    DBMS_OUTPUT.PUT_LINE('Welcome');
    END;
  
   --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DECLARE
  veName VARCHAR2(20) NOT NULL := 'Tirtharaj';
  id NUMBER;
BEGIN
  veName := 'Tirtharaj';
  DBMS_OUTPUT.PUT_LINE(veName||' '||id);
  END;
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DECLARE
  aid number;
  fName varchar(50);
  lName varchar(50);
  BEGIN
    select associateId,firstName,lastName INTO aid,fName,lName
      from Associate
        where AssociateId=&aid;
      DBMS_OUTPUT.PUT_LINE(aid||''||fName||''||lName);
  END;
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DECLARE
  aid ASSOCIATE.ASSOCIATEID%TYPE;
  fName ASSOCIATE.FIRSTNAME%TYPE;
  lName ASSOCIATE.LASTNAME%TYPE;
  BEGIN
    select associateId,firstName,lastName INTO aid,fName,lName
      from Associate
        where AssociateId=&aid;
      DBMS_OUTPUT.PUT_LINE(aid||''||fName||''||lName);
  END;
 --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 DECLARE
  associateRow ASSOCIATE%ROWTYPE;
  BEGIN
    select * INTO associateRow
      from Associate
        where associateId=&aid;
      DBMS_OUTPUT.PUT_LINE(associateRow.ASSOCIATEDID);
  END;
   --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
   DECLARE
    CURSOR associateCursor is select * from Associate;
    associateRow ASSOCIATE%ROWTYPE;
 begin
    OPEN associateCursor,
    LOOP
      FETCH associateCursor INTO associateRow;
        DBMS_OUTPUT.PUT_LINE(associateRow.ASSOCIATEID||' '||associateRow.firstName||' '||associateRow.lastName);
        EXIT WHEN associateCursor%NOTFOUND;
      END LOOP;
    CLOSE associateCursor;
  end;
   --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 DECLARE
  aid number;
  fName varchar(50);
  lName varchar(50);
  BEGIN
    select associateId,firstName,lastName INTO aid,fName,lName
      from Associate
        where AssociateId=&aid;
      DBMS_OUTPUT.PUT_LINE(aid||''||fName||''||lName);
    EXCEPTION
      WHEN NO_DATA_FOUND THEN
        DBMS_OUTPUT.PUT_LINE('No employee exits');
      WHEN TOO_MANY_ROWS THEN
        DBMS_OUTPUT.PUT_LINE('Too many records found');
  END;  
   --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DECLARE
  CURSOR associateCursor is select * from Associate
                                                    where YEARLYINVERSTMENTUNDER80C>=&YEARLYINVERSTMENTUNDER80C;
  associateRow ASSOCIATE%ROWTYPE;
  NO_Records_Found EXCEPTION;
begin
  OPEN associateCursor;
  FETCH associateCursor INTO associateRow;
  IF associateCursor%ROWCOUNT>0
    THEN
    LOOP
      FETCH associateCursor INTO associateRow;
       EXIT WHEN associateCursor%NOTFOUND;
      DBMS_OUTPUT.PUT_LINE(associateRow.ASSOCIATEID||' '||associateRow.firstName||' '||associateRow.lastName);
     
    END LOOP;
    ELSE
      RAISE NO_Records_Found;
    END IF;
      CLOSE associateCursor;
      
      EXCEPTION
        WHEN No_Records_Found THEN
          DBMS_OUTPUT.PUT_LINE('No Details Found');
END;
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  
  create or replace PROCEDURE sp_FindAssociatedetails
  AS CURSOR associateCursor is select * from Associate
                                                              where YEARLYINVERSTMENTUNDER80C>=10000;
    associateRow ASSOCIATE%ROWTYPE;
   begin
  OPEN associateCursor;
  FETCH associateCursor INTO associateRow;
  IF associateCursor%ROWCOUNT>0
    THEN
    LOOP
      FETCH associateCursor INTO associateRow;
       EXIT WHEN associateCursor%NOTFOUND;
      DBMS_OUTPUT.PUT_LINE(associateRow.ASSOCIATEID||' '||associateRow.firstName||' '||associateRow.lastName);
     
    END LOOP;
    ELSE
      RAISE NO_Records_Found;
    END IF;
      CLOSE associateCursor;
      
      EXCEPTION
        WHEN No_Records_Found THEN
          DBMS_OUTPUT.PUT_LINE('No Details Found');
END sp_FindAssociateDetails;
  
  
  
  
  
  
  
  
  
  